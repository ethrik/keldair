#!/usr/bin/env perl
# Copyright 2011 Ethrik Project, et al.
# Licensed under the 3-clause BSD.
use strict;
use warnings;
use FindBin qw($Bin);
use lib "$Bin/lib";

BEGIN
{
	if(!-e "$Bin/etc/keldair.conf")
	{
		die "Could not find etc/keldair.conf\n";
	}
	fork and exit;
	local $0 = 'keldair';
}

use Keldair;
use Keldair::Module::Sample;

my $sock = $keldair->connect();

while(my $buffer = <$sock>)
{
	print "R: $buffer" if $keldair->debug;
	chomp $buffer;
	chop $buffer;
	$keldair->parse($buffer);
}

close $sock;
